<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Spring 关于IOC</title>
      <link href="/2020/01/30/Spring-IOC/"/>
      <url>/2020/01/30/Spring-IOC/</url>
      
        <content type="html"><![CDATA[<h2 id="IOC初体验"><a href="#IOC初体验" class="headerlink" title="IOC初体验"></a>IOC初体验</h2><h3 id="0-Maven工程结构"><a href="#0-Maven工程结构" class="headerlink" title="(0).  Maven工程结构"></a>(0).  Maven工程结构</h3><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200130223516.png" alt=""></p><h3 id="1-导入依赖"><a href="#1-导入依赖" class="headerlink" title="(1)  导入依赖"></a>(1)  导入依赖</h3><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-context<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>5.0.2.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre><p>这个依赖包括以下jar包：</p><blockquote><p>Maven: org.springframework:spring-aop:5.0.2.RELEASE    （AOP）<br>Maven: org.springframework:spring-beans:5.0.2.RELEASE    （IOC）<br>Maven: org.springframework:spring-context:5.0.2.RELEASE    （IOC）<br>Maven: org.springframework:spring-core:5.0.2.RELEASE    （IOC）<br>Maven: org.springframework:spring-expression:5.0.2.RELEASE    （IOC）<br>Maven: org.springframework:spring-jcl:5.0.2.RELEASE    （日志包 common-logging）</p></blockquote><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200130221442.png" alt=""></p><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200130225721.png" alt=""></p><h3 id="2-配置文件：applicationContext-xml"><a href="#2-配置文件：applicationContext-xml" class="headerlink" title="(2).  配置文件：applicationContext.xml"></a>(2).  配置文件：<code>applicationContext.xml</code></h3><pre class=" language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans        https://www.springframework.org/schema/beans/spring-beans.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- 把对象的创建交给spring来管理 --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>accountService<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.yang.service.impl.AccountServiceImpl<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>accountDao<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.yang.dao.impl.AccountDaoImpl<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span></code></pre><h3 id="3-测试"><a href="#3-测试" class="headerlink" title="(3).  测试"></a>(3).  测试</h3><pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>yang<span class="token punctuation">.</span>ui<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>yang<span class="token punctuation">.</span>dao<span class="token punctuation">.</span>AccountDao<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>yang<span class="token punctuation">.</span>service<span class="token punctuation">.</span>AccountService<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>yang<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>AccountServiceImpl<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>ApplicationContext<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>support<span class="token punctuation">.</span>ClassPathXmlApplicationContext<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">/**     * 获取spring的IOC核心容器，并根据id获取对象     * @param args     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        ApplicationContext context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">"applicationContext.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        AccountService as <span class="token operator">=</span> <span class="token punctuation">(</span>AccountService<span class="token punctuation">)</span> context<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">"accountService"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        AccountDao ad <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span>AccountDao<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>as<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ad<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h3 id="4-输出结果"><a href="#4-输出结果" class="headerlink" title="(4).  输出结果"></a>(4).  输出结果</h3><pre><code>com.yang.service.impl.AccountServiceImpl@448ff1a8com.yang.dao.impl.AccountDaoImpl@1a38c59b</code></pre><h2 id="核心容器的两个接口"><a href="#核心容器的两个接口" class="headerlink" title="核心容器的两个接口"></a>核心容器的两个接口</h2><p><strong>ApplicationContext（适用于单例对象）：</strong></p><p>在构建核心容器时，采用【立即加载】的方式创建对象，即一读取完配置文件马上创建配置文件中的对象</p><p>BeanFactory（适用于多例对象）：</p><p>在构建核心容器时，采用【延迟加载】的方式创建对象，即根据id获取对象时才创建配置文件中的对象</p><h2 id="ApplicationContext的三个常用实现类"><a href="#ApplicationContext的三个常用实现类" class="headerlink" title="ApplicationContext的三个常用实现类"></a>ApplicationContext的三个常用实现类</h2><p>ClassPathXmlApplicationContext：可以加载类路径下的配置文件【项目里】</p><p>FileSystemXmlApplicationContext：可以加载磁盘任意路径下的配置文件（必须有访问权限）【本地电脑里】</p><p>AnnotationConfigApplicationContext：用于读取注解创建容器的【项目里】</p><h2 id="Spring创建bean的细节"><a href="#Spring创建bean的细节" class="headerlink" title="Spring创建bean的细节"></a>Spring创建bean的细节</h2><h3 id="bean的三种创建方式"><a href="#bean的三种创建方式" class="headerlink" title="bean的三种创建方式"></a>bean的三种创建方式</h3><p><strong>第一种：使用默认构造函数创建</strong></p><p>在Spring的配置文件中使用bean标签，配置id和class之后，且没有其他属性和标签时。</p><p>采用的时默认构造函数创建bean对象，此时如果类中没有默认构造函数，则对象无法创建</p><blockquote><p>问：为什么是无参构造函数，而不是有参构造函数？</p><p>因为IOC核心容器是通过反射创建bean对象的，而创建一个不带属性的bean，需要使用对应类的无参构造函数来创建。</p></blockquote><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200130231925.png" alt=""></p><p><strong>方法二：使用普通类中的方法的返回值创建对象，并存入spring容器中</strong></p><pre><code>等价于：【对象.方法】InstanceFactory instanceFactory  = new InstanceFactory();AccountDao accountDao = instanceFactory.getAccount();</code></pre><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200130234740.png" alt=""></p><p><strong>方法三：使用某个类中的静态方法创建对象</strong></p><pre><code>等价于：【类.静态方法】，静态方法也可以使用方式二AccountDao accountDao = StaticFactory.getAccount();</code></pre><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200131000342.png" alt=""></p><h3 id="bean的作用范围"><a href="#bean的作用范围" class="headerlink" title="bean的作用范围"></a>bean的作用范围</h3><p>bean默认是单例的</p><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200131000755.png" alt=""></p><p>通过bean标签的scope属性可以指定bean的作用范围</p><blockquote><p>scope属性的取值</p><ul><li>singleton：单例（默认）</li><li>prototype：多例</li><li>request：作用于web应用的请求范围</li><li>session：作用于web应用的会话范围</li><li>global-session：作用于集群环境的会话范围（全局会话范围）</li></ul></blockquote><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200131001443.png" alt=""></p><h3 id="bean对象的生命周期"><a href="#bean对象的生命周期" class="headerlink" title="bean对象的生命周期"></a>bean对象的生命周期</h3><p>单例对象：立即加载，立即销毁</p><blockquote><p>出生：当容器创建时，对象出生</p><p>活着：容器在，对象在</p><p>死亡：容器销毁，对象消亡</p><p>总结——单例对象的生命周期和容器相同</p></blockquote><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200131002614.png" alt=""></p><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200131002528.png" alt=""></p><p>多例对象：延迟加载，延迟销毁</p><blockquote><p>出生：使用对象时，spring容器为我们创建</p><p>活着：对象只要在使用过程中，就一直活着</p><p>死亡：当对象长时间不用，且没有别的对象引用时，由Java的垃圾回收器回收</p></blockquote><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200131003430.png" alt=""></p><h2 id="IOC初体验（完善）Spring-依赖注入"><a href="#IOC初体验（完善）Spring-依赖注入" class="headerlink" title="IOC初体验（完善）Spring 依赖注入"></a>IOC初体验（完善）Spring 依赖注入</h2><p>在IOC初体验中，我们成功通过配置文件创建了对象，但是无法调用方法；</p><p>因为我们只是创建了对象，但是没有将accountDao对象注入到accountService对象中</p><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200130230016.png" alt=""></p><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200130230404.png" alt=""></p><h3 id="依赖注入-简介"><a href="#依赖注入-简介" class="headerlink" title="依赖注入 简介"></a>依赖注入 简介</h3><p>DI，Dependency Injection，依赖注入</p><blockquote><p>IOC的作用：降低程序间的耦合（依赖关系）</p><p>什么是依赖关系：在当前类需要用到其他类的对象，由Spring提供，我们只需在配置文件中说明</p><p>依赖关系的维护（管理），就称之为依赖注入</p></blockquote><blockquote><p><strong>依赖注入能注入的数据有3类：</strong></p><p>(1)  基本类型和String</p><p>(2)  其他bean类型（在配置文件中或注解配置过的bean）</p><p>(3)  复杂类型（集合类型）</p><p><strong>注入的方式，有3种：</strong></p><p>(1)  使用构造函数注入</p><p>(2)  使用set方法注入 </p><p>(3)  使用注解注入</p></blockquote><h4 id="使用构造函数注入"><a href="#使用构造函数注入" class="headerlink" title="使用构造函数注入"></a>使用构造函数注入</h4><p>之前创建的bean都是没有属性的，也就是使用默认的无参构造函数通过反射创建的对象。</p><p>若要使用有参构造函数，就需要注入构造函数需要的属性了。</p><blockquote><p>标签：<code>&lt;constructor-arg&gt;</code></p><p>属性：</p><ul><li><p>type：指定要注入的数据的数据类型</p></li><li><p>index：指定要注入的数据在构造函数中的索引位置（从0开始）</p></li><li><p>name：指定要注入的数据的名称（常用）</p><hr></li><li><p>value：提供基本类型和String类型的数据</p></li><li><p>ref：指定在IOC容器中出现的bean对象</p></li></ul></blockquote><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200131010827.png" alt=""></p><p>优势：在获取bean对象时，注入数据是必要的操作，否则对象无法创建成功</p><p>弊端：改变了bean实例化方式，在创建对象时，若用不到某些属性，也需要提供（一个属性都不能少）</p><h4 id="set方法注入"><a href="#set方法注入" class="headerlink" title="set方法注入"></a>set方法注入</h4><blockquote><p>涉及的标签：<code>property</code></p><p>属性：</p><ul><li><p>name：指定注入时所调用的set名称（set去掉，首字母小写）</p></li><li><p>value：提供基本类型和String类型的数据</p></li><li><p>ref：指定在IOC容器中出现的bean对象</p></li></ul></blockquote><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200131012037.png" alt=""></p><p>优势：创建对象时没有明确限制，可以直接使用默认构造函数（不用指明所有属性）</p><p>弊端：若某个成员必须有值，则获取对象时无法保证一定注入（不一定写了set方法，没写就无法注入）</p><h4 id="复杂类型注入"><a href="#复杂类型注入" class="headerlink" title="复杂类型注入"></a>复杂类型注入</h4><blockquote><p>用于给List结构集合注入的标签：<code>&lt;list&gt;,&lt;array&gt;,&lt;set&gt;</code></p><p>用于给Map结构集合注入的标签：<code>&lt;map&gt;,&lt;props&gt;</code></p><p>也就是说，可以互换</p></blockquote><p>实体类</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">AccountService</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> myStrs<span class="token punctuation">;</span>    <span class="token keyword">private</span> List<span class="token operator">&lt;</span>String<span class="token operator">></span> myList<span class="token punctuation">;</span>    <span class="token keyword">private</span> Set<span class="token operator">&lt;</span>String<span class="token operator">></span> mySet<span class="token punctuation">;</span>    <span class="token keyword">private</span> Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span>Object<span class="token operator">></span> myMap<span class="token punctuation">;</span>    <span class="token keyword">private</span> Properties myProps<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMyStrs</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> myStrs<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>myStrs <span class="token operator">=</span> myStrs<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMyList</span><span class="token punctuation">(</span>List<span class="token operator">&lt;</span>String<span class="token operator">></span> myList<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>myList <span class="token operator">=</span> myList<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMySet</span><span class="token punctuation">(</span>Set<span class="token operator">&lt;</span>String<span class="token operator">></span> mySet<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>mySet <span class="token operator">=</span> mySet<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMyMap</span><span class="token punctuation">(</span>Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token operator">></span> myMap<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>myMap <span class="token operator">=</span> myMap<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMyProps</span><span class="token punctuation">(</span>Properties myProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>myProps <span class="token operator">=</span> myProps<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveAccount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Arrays<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>myStrs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>myList<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>mySet<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>myMap<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>myProps<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>IOC容器</p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>accountService<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.yang.service.AccountServiceImpl<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myStrs<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>array</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>AAA<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>BBB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>CCC<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>array</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myList<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>list</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>AAA<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>BBB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>CCC<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>list</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mySet<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>set</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>AAA<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>BBB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>CCC<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>set</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myMap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>map</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>testA<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>aaa<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>testB<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>bbb<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>map</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myProps<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>props</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prop</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>testC<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ccc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prop</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prop</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>testD<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ddd<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prop</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>props</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span></code></pre><p>测试</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>    ApplicationContext context <span class="token operator">=</span>        <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">"applicationContext.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    AccountService as <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span>AccountService<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    as<span class="token punctuation">.</span><span class="token function">saveAccount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>输出结果</p><pre><code>[AAA, BBB, CCC][AAA, BBB, CCC][AAA, BBB, CCC]{testA=aaa, testB=bbb}{testD=ddd, testC=ccc}</code></pre>]]></content>
      
      
      <categories>
          
          <category> Java框架 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> IOC容器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBoot 整合</title>
      <link href="/2020/01/30/SpringBoot%20%E6%95%B4%E5%90%88/"/>
      <url>/2020/01/30/SpringBoot%20%E6%95%B4%E5%90%88/</url>
      
        <content type="html"><![CDATA[<h2 id="将要做的几件事"><a href="#将要做的几件事" class="headerlink" title="将要做的几件事"></a>将要做的几件事</h2><blockquote><p><strong>整合SpringMVC</strong></p><ol><li>修改端口（server.port=8888）</li><li>访问静态资源（classpath:META/resources | classpath:resources | classpath:static |classpath:public）</li><li>配置拦截器<ol><li>自定义拦截器：实现HandlerInterceptor接口</li><li>配置拦截器：自定义一个Java配置类（@Configuration），实现WebMvcConfigurer接口</li></ol></li></ol><p><strong>整合数据源</strong></p><ol><li>引入jdbc启动器，mysql驱动</li><li>添加配置<ol><li>spring.datasource.url</li><li>spring.datasource.username</li><li>spring.datasource.password</li></ol></li></ol><p><strong>整合Mybatis</strong></p><ol><li>引入启动器</li><li>覆盖默认配置<ol><li>mybatis.type-aliases-package=com.yang.boot.bean</li><li>mybatis.mapper-locations=<code>classpath:mybatis/mappers/**/*.xml</code></li><li>代码：定义一个接口，在接口上加入@Mapper注解</li></ol></li></ol><p><strong>整合通用Mapper</strong></p><ol><li>引入启动器</li><li>代码：接口继承<code>Mapper</code></li></ol><p><strong>整合事务</strong></p><ol><li>添加@Transactional</li></ol></blockquote><h2 id="1-整合-SpringMVC"><a href="#1-整合-SpringMVC" class="headerlink" title="1. 整合 SpringMVC"></a>1. 整合 SpringMVC</h2><h3 id="配置拦截器"><a href="#配置拦截器" class="headerlink" title="配置拦截器"></a>配置拦截器</h3><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200125204045.png" alt="img"></p><p>(0) 项目结构：</p><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200125232518.png" alt="img"></p><p>(1) 拦截器： <code>com.yang.demospringmvc.interceptor.MyInterceptor.java</code></p><pre><code>package com.yang.boot.demospringmvc.interceptor;import org.springframework.stereotype.Component;import org.springframework.stereotype.Controller;import org.springframework.web.servlet.HandlerInterceptor;import org.springframework.web.servlet.ModelAndView;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;@Component  //注册到spring容器中public class MyInterceptor implements HandlerInterceptor {    @Override    public boolean preHandle(HttpServletRequest request,                             HttpServletResponse response,                             Object handler) throws Exception {        System.out.println(&quot;前置方法正在执行...&quot;);        // 返回值 true:放行 false:拦截        return true;    }    @Override    public void postHandle(HttpServletRequest request,                           HttpServletResponse response,                           Object handler,                           ModelAndView modelAndView) throws Exception {        System.out.println(&quot;后置方法正在执行...&quot;);    }    @Override    public void afterCompletion(HttpServletRequest request,                                HttpServletResponse response,                                Object handler,                                Exception ex) throws Exception {        System.out.println(&quot;完成方法正在执行...&quot;);    }}</code></pre><p>(2) 自定义拦截器配置类：<code>com.yang.demospringmvc.config.WebMvcCOnfiguration.java</code></p><pre><code>package com.yang.boot.demospringmvc.config;import com.yang.boot.demospringmvc.interceptor.MyInterceptor;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.context.annotation.Configuration;import org.springframework.web.servlet.config.annotation.InterceptorRegistry;import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;/** * 1. 声明这是一个配置类 * 2. 实现 WebMvcConfigurer 接口 */@Configurationpublic class WebMvcConfiguration implements WebMvcConfigurer {    @Autowired    private MyInterceptor myInterceptor;    @Override    public void addInterceptors(InterceptorRegistry registry) {        // &quot;/*&quot;表示所有单级请求   &quot;/**&quot;表示所有多级请求        registry.addInterceptor(myInterceptor).                addPathPatterns(&quot;/**&quot;);    }}</code></pre><p>(3) 控制器：<code>com.yang.demospringmvc.controller.UserController.java</code></p><pre><code>package com.yang.boot.demospringmvc.controller;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.ResponseBody;@Controllerpublic class UserController {    @RequestMapping(&quot;hello&quot;)    @ResponseBody    public String hello(){        return &quot;hello&quot;;    }}</code></pre><p>(4) 全局配置文件：<code>application.properties</code></p><pre><code># 修改服务器端口server.port=8888# 修改日志级别logging.level.org.springframework=DEBUG</code></pre><p>(5) 引导类：<code>com.yang.demospringmvc.DemoSpringmvcApplication.java</code></p><pre><code>package com.yang.boot.demospringmvc;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;@SpringBootApplicationpublic class DemoSpringmvcApplication {    public static void main(String[] args) {        SpringApplication.run(DemoSpringmvcApplication.class, args);    }}</code></pre><p>(6) 输出结果</p><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200125232107.png" alt="img"></p><h2 id="2-整合数据源-内置"><a href="#2-整合数据源-内置" class="headerlink" title="2. 整合数据源[内置]"></a>2. 整合数据源[内置]</h2><p><code>SpringBoot</code> 默认数据源为 <code>HikariCP</code>，是一个高性能的JDBC连接池，性能高。</p><p>(1) 引入依赖：<code>pom.xml</code></p><pre><code>&lt;dependency&gt;    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;    &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt;    &lt;groupId&gt;mysql&lt;/groupId&gt;    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;&lt;/dependency&gt;</code></pre><p>(2) 全局配置文件：<code>application.properties</code></p><pre><code># 修改服务器端口server.port=8888# 修改日志级别logging.level.org.springframework=DEBUGspring.datasource.url=jdbc:mysql://localhost:3306/springbootspring.datasource.username=rootspring.datasource.password=123456</code></pre><h2 id="3-整合Mybatis"><a href="#3-整合Mybatis" class="headerlink" title="3. 整合Mybatis"></a>3. 整合Mybatis</h2><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200126110900.png" alt="img"></p><p>(1) 导入依赖：<code>pom.xml</code></p><pre><code>&lt;!-- mybatis --&gt;&lt;dependency&gt;    &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;    &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;    &lt;version&gt;1.3.2&lt;/version&gt;&lt;/dependency&gt;&lt;!-- 通用Mapper,作者开发的 --&gt;&lt;dependency&gt;    &lt;groupId&gt;tk.mybatis&lt;/groupId&gt;    &lt;artifactId&gt;mapper-spring-boot-starter&lt;/artifactId&gt;    &lt;version&gt;2.0.2&lt;/version&gt;&lt;/dependency&gt;</code></pre><p>(2) 全局配置文件：<code>application.properties</code></p><pre><code># 修改服务器端口server.port=8888# 修改日志级别logging.level.org.springframework=DEBUGspring.datasource.url=jdbc:mysql://localhost:3306/springbootspring.datasource.username=rootspring.datasource.password=123456mybatis.type-aliases-package=com.yang.boot.demospringmvc.bean#mybatis-mapper-locations=clsspath:mybatis/mappers/**/*.xml</code></pre><p>(3) 实体类：<code>com.yang.boot.demospringboot.bean.User.java</code></p><pre><code>package com.yang.boot.demospringmvc.bean;import org.hibernate.validator.constraints.ISBN;import javax.persistence.GeneratedValue;import javax.persistence.GenerationType;import javax.persistence.Id;import javax.persistence.Table;@Table(name = &quot;tb_user&quot;)public class User {    @Id    @GeneratedValue(strategy = GenerationType.IDENTITY)    private Long id;    private String username;    private String password;    //getter setter}</code></pre><p>(4) Mybatis 映射接口：<code>com.yang.boot.demospringboot.mapper.UserMapper.java</code></p><pre><code>package com.yang.boot.demospringmvc.mapper;import com.yang.boot.demospringmvc.bean.User;import org.apache.ibatis.annotations.Mapper;/** * 整合Mybatis：需要实现通用 Mapper 接口 */@Mapperpublic interface UserMapper extends tk.mybatis.mapper.common.Mapper&lt;User&gt; {}</code></pre><h2 id="4-整合事务"><a href="#4-整合事务" class="headerlink" title="4. 整合事务"></a>4. 整合事务</h2><p>Maven已经将<code>org.springframework:spring.tx</code>依赖导入了，因此无需再导入依赖。</p><p>业务层：<code>com.yang.boot.demospringboot.UserService.java</code></p><pre><code>package com.yang.boot.demospringmvc.service;import com.yang.boot.demospringmvc.bean.User;import com.yang.boot.demospringmvc.mapper.UserMapper;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;import org.springframework.transaction.annotation.Transactional;@Servicepublic class UserService {    @Autowired    private UserMapper userMapper;    public User queryUserById(Long id){        return this.userMapper.selectByPrimaryKey(id);    }    @Transactional    public void deleteUserById(Long id){        this.userMapper.deleteByPrimaryKey(id);    }}</code></pre><h2 id="测试整合结果"><a href="#测试整合结果" class="headerlink" title="测试整合结果"></a>测试整合结果</h2><pre><code>package com.yang.boot.demospringmvc.controller;import com.yang.boot.demospringmvc.bean.User;import com.yang.boot.demospringmvc.service.UserService;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.PathVariable;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.ResponseBody;@Controller@RequestMapping(&quot;user&quot;)public class UserController {    @Autowired    private UserService userService;    // 通过ID查询用户    @GetMapping(&quot;{id}&quot;)    @ResponseBody    public User queryUserById(@PathVariable(&quot;id&quot;)Long id){        return this.userService.queryUserById(id);    }    @RequestMapping(&quot;hello&quot;)    @ResponseBody    public String hello(){        return &quot;hello&quot;;    }}</code></pre><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200126113739.png" alt="img"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>SpringBoot 入门</title>
      <link href="/2020/01/30/SpringBoot%20%E5%85%A5%E9%97%A8/"/>
      <url>/2020/01/30/SpringBoot%20%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="简单介绍"><a href="#简单介绍" class="headerlink" title="简单介绍"></a>简单介绍</h2><h2 id="第一个SprinBoot程序"><a href="#第一个SprinBoot程序" class="headerlink" title="第一个SprinBoot程序"></a>第一个SprinBoot程序</h2><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200126134134.png" alt="img"></p><p>引入启动器</p><pre><code>&lt;-- 所有的springboot都要继承该父工程 --&gt;&lt;parent&gt;    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;    &lt;version&gt;2.2.4.RELEASE&lt;/version&gt;    &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;&lt;/parent&gt;&lt;-- web启动器 --&gt;&lt;dependency&gt;    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;</code></pre><p>控制器类</p><pre><code>package com.yang.demo.controller;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.ResponseBody;@Controller@RequestMapping(&quot;demo&quot;)public class DemoController {    @RequestMapping(&quot;hello&quot;)    @ResponseBody    public String Hello(){        return &quot;hello springboot!&quot;;    }}</code></pre><p>引导类：</p><pre><code>package com.yang.demo;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;/** * @SpringBootApplication =  *      * @EnableAutoConfiguration：启用自动配置 *      * @ComponentScan：开启注解扫描 *      * SpringBootConfiguration：作用等同于@Configuration，表示该类是一个配置类，不同的是一个工程只包含一个该注解 */@SpringBootApplicationpublic class DemoApplication {    public static void main(String[] args) {        SpringApplication.run(DemoApplication.class, args);    }}</code></pre><p>输出结果</p><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200126133018.png" alt="img"></p><h2 id="自定义配置类"><a href="#自定义配置类" class="headerlink" title="自定义配置类"></a>自定义配置类</h2><p>SpringBoot内部已经配置了一百多个配置类（真是贴心啊），我们可以直接使用</p><p>当我们需要其他的配置类时，我们也可以自定义一个配置类</p><p>回顾以前SSM配置数据库连接池的方式：</p><pre><code>&lt;bean name=&quot;dataSource&quot; class=&quot;com.alibaba.druid.pool.DruidDataSource&quot; init-method=&quot;init&quot; destroy-method=&quot;close&quot;&gt;    &lt;property name=&quot;driverClassName&quot; value=&quot;${jdbc.driverClassName}&quot; /&gt;     &lt;property name=&quot;url&quot; value=&quot;${jdbc.url}&quot; /&gt;    &lt;property name=&quot;username&quot; value=&quot;${jdbc.username}&quot; /&gt;    &lt;property name=&quot;password&quot; value=&quot;${jdbc.password}&quot; /&gt;&lt;/bean&gt;</code></pre><p>SpringBoot使用Java配置类，来代替xml配置：</p><blockquote><p>@Configuration：声明一个类作为配置类，代替<code>xml</code>文件</p><p>@Bean：声明在方法上，将方法的返回值加入spring容器，代替``标签</p><p>@PropertySource：指定外部属性文件</p><p>@Value：属性注入</p></blockquote><h3 id="传统配置类"><a href="#传统配置类" class="headerlink" title="传统配置类"></a>传统配置类</h3><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200126135650.png" alt="img"></p><p>引入启动器</p><pre><code>&lt;dependency&gt;    &lt;groupId&gt;com.github.drtrang&lt;/groupId&gt;    &lt;artifactId&gt;druid-spring-boot2-starter&lt;/artifactId&gt;    &lt;version&gt;1.1.10&lt;/version&gt;&lt;/dependency&gt;</code></pre><p>jdbc配置文件</p><pre><code>jdbc.driverClassName=com.mysql.jdbc.Driverjdbc.url=jdbc:mysql:///speingbootjdbc.username=rootjdbc.password=123456</code></pre><p>java配置类</p><pre><code>package com.yang.demo.config;import com.alibaba.druid.pool.DruidDataSource;import org.springframework.beans.factory.annotation.Value;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import org.springframework.context.annotation.PropertySource;import javax.sql.DataSource;@Configuration@PropertySource(&quot;classpath:jdbc.properties&quot;)public class jdbcConfiguration {    @Value(&quot;${jdbc.driverClassName}&quot;)    private String driverClassName;    @Value(&quot;${jdbc.url}&quot;)    private String url;    @Value(&quot;${jdbc.username}&quot;)    private String username;    @Value(&quot;${jdbc.password}&quot;)    private String password;    @Bean    public DataSource dataSource(){        DruidDataSource dataSource = new DruidDataSource();        dataSource.setDriverClassName(this.driverClassName);        dataSource.setUrl(this.url);        dataSource.setUsername(this.username);        dataSource.setPassword(this.password);        return dataSource;    }}</code></pre><p>控制器</p><pre><code>package com.yang.demo.controller;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.ResponseBody;import javax.sql.DataSource;@Controller@RequestMapping(&quot;demo&quot;)public class DemoController {    @Autowired    private DataSource dataSource;    @RequestMapping(&quot;hello&quot;)    @ResponseBody    public String Hello(){        return &quot;hello springboot!&quot;;    }}</code></pre><h3 id="SpringBoot配置类"><a href="#SpringBoot配置类" class="headerlink" title="SpringBoot配置类"></a>SpringBoot配置类</h3><p>接下来使用SpringBoot来进行连接池配置：</p><p>思路：使用SpringBoot内置的属性配置文件，将读取属性的步骤单独抽取出来，达到复用的效果</p><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200126153106.png" alt="img"></p><p>属性配置文件：<code>application.properties</code></p><pre><code>jdbc.driverClassName=com.mysql.jdbc.Driverjdbc.url=jdbc:mysql:///speingbootjdbc.username=rootjdbc.password=123456</code></pre><p>读取属性的类</p><pre><code>package com.yang.demo.config;import org.springframework.boot.context.properties.ConfigurationProperties;@ConfigurationProperties(prefix = &quot;jdbc&quot;) //读取资源配置类中，前缀为jdbc的属性public class JdbcProperties {    private String driverClassName;    private String url;    private String username;    private String password;    //getter setter}</code></pre><p>配置类</p><pre><code>package com.yang.demo.config;import com.alibaba.druid.pool.DruidDataSource;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.boot.context.properties.EnableConfigurationProperties;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import javax.sql.DataSource;@Configuration@EnableConfigurationProperties(JdbcProperties.class) //启动资源配置读取类public class jdbcConfiguration {    // 方法1 @Autowired注入    @Autowired    private JdbcProperties jdbcProperties;    @Bean     public DataSource dataSource(){        DruidDataSource dataSource = new DruidDataSource();        dataSource.setDriverClassName(this.jdbcProperties.getDriverClassName());        dataSource.setUrl(this.jdbcProperties.getUrl());        dataSource.setUsername(this.jdbcProperties.getUsername());        dataSource.setPassword(this.jdbcProperties.getPassword());        return dataSource;    }}</code></pre><h3 id="属性注入的4种方法"><a href="#属性注入的4种方法" class="headerlink" title="属性注入的4种方法"></a>属性注入的4种方法</h3><p>上述配置类，使用@Autowired注入了属性，还可以采用其他方式注入：</p><pre><code>// 方法1 @Autowired注入@Autowiredprivate JdbcProperties jdbcProperties;// 方法2 构造器参数注入private JdbcProperties jdbcProperties;public jdbcConfiguration(JdbcProperties jdbcProperties){    this.jdbcProperties = jdbcProperties;}// 方法3 作为形参注入@Beanpublic DataSource dataSource(JdbcProperties jdbcProperties){    DruidDataSource dataSource = new DruidDataSource();    dataSource.setDriverClassName(jdbcProperties.getDriverClassName());    dataSource.setUrl(jdbcProperties.getUrl());    dataSource.setUsername(jdbcProperties.getUsername());    dataSource.setPassword(jdbcProperties.getPassword());    return dataSource;}// 方法4 @Bean + @ConfigurationProperties@Configurationpublic class jdbcConfiguration {    // 将jdbcProperties.java的ConfigurationProperties移动到此处    @Bean    @ConfigurationProperties(prefix = &quot;jdbc&quot;) //读取资源配置类中，前缀为jdbc的属性    public DataSource dataSource(){        DruidDataSource dataSource = new DruidDataSource();        return dataSource;    }}</code></pre><h2 id="自动配置原理"><a href="#自动配置原理" class="headerlink" title="自动配置原理"></a>自动配置原理</h2>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>SpringBoot thymeleaf</title>
      <link href="/2020/01/30/SpringBoot%20thymeleaf/"/>
      <url>/2020/01/30/SpringBoot%20thymeleaf/</url>
      
        <content type="html"><![CDATA[<h2 id="简单介绍"><a href="#简单介绍" class="headerlink" title="简单介绍"></a>简单介绍</h2><p>SpringBoot不支持jsp，但是支持一些模板引擎技术</p><p>主流的模板引擎技术：</p><blockquote><p>FreeMarker</p><p>==Thymeleaf==</p><p>Mustache</p></blockquote><p>SpringBoot 常用的模板引擎技术是<code>Thymeleaf</code></p><p><code>Thymeleaf</code>可以完全替代JSP，有以下4个特点：</p><blockquote><p>动静结合（有无网络均可运行）</p><p>开箱即用</p><p>多方言支持</p><p>与SpringBoot完美整合</p></blockquote><pre><code>Thymeleaf`默认解析位置：`src/main/resources/templates/xxx.html</code></pre><h2 id="第一个thymeleaf程序"><a href="#第一个thymeleaf程序" class="headerlink" title="第一个thymeleaf程序"></a>第一个thymeleaf程序</h2><p>以下配置是基于SpringBoot整合的基础上，若没有配置，请移步配置。</p><p>引入启动器</p><pre><code>&lt;dependency&gt;    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;    &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;&lt;/dependency&gt;</code></pre><p>修改默认配置：</p><p>thymeleaf会在第一次对模板解析之后进行缓存，提高了并发处理能力</p><p>但是给开发带来了不便（修改页面并不会立即看到效果），因此在<code>开发阶段</code>关闭缓存。</p><pre><code># 关闭thymeleaf缓存spring.thymeleaf.cache=false</code></pre><p>DAO层接口：</p><pre><code>package com.yang.boot.demospringmvc.mapper;import com.yang.boot.demospringmvc.bean.User;import org.apache.ibatis.annotations.Mapper;/** * 整合Mybatis：需要实现通用 Mapper 接口 */@Mapperpublic interface UserMapper extends tk.mybatis.mapper.common.Mapper&lt;User&gt; {}</code></pre><p>业务层：</p><pre><code>package com.yang.boot.demospringmvc.service;import com.yang.boot.demospringmvc.bean.User;import com.yang.boot.demospringmvc.mapper.UserMapper;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;import java.util.List;@Servicepublic class UserService {    @Autowired    private UserMapper userMapper;    public List&lt;User&gt; queryAllUser(){        return this.userMapper.selectAll();    }}</code></pre><p>控制层：</p><pre><code>package com.yang.boot.demospringmvc.controller;import com.yang.boot.demospringmvc.bean.User;import com.yang.boot.demospringmvc.service.UserService;import org.apache.logging.log4j.message.ReusableMessage;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.ui.Model;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.PathVariable;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.ResponseBody;import java.util.List;@Controller@RequestMapping(&quot;user&quot;)public class UserController {    @Autowired    private UserService userService;    @GetMapping(&quot;all&quot;)    public String queryAllUser(Model model){        List&lt;User&gt; userList = this.userService.queryAllUser();        model.addAttribute(&quot;userList&quot;,userList);        return &quot;users&quot;;    }}</code></pre><p>静态文件：</p><pre><code>&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot; xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;用户列表&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;div&gt;        &lt;table border=&quot;1&quot;&gt;            &lt;tr&gt;                &lt;th&gt;ID&lt;/th&gt;                &lt;th&gt;姓名&lt;/th&gt;                &lt;th&gt;密码&lt;/th&gt;            &lt;/tr&gt;            &lt;tr th:each=&quot;user:${userList}&quot;&gt;                &lt;td th:text=&quot;${user.id}&quot;&gt;1&lt;/td&gt;                &lt;td th:text=&quot;${user.username}&quot;&gt;张三&lt;/td&gt;                &lt;td th:text=&quot;${user.password}&quot;&gt;333&lt;/td&gt;            &lt;/tr&gt;        &lt;/table&gt;    &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p><img src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/newpic/20200126125027.png" alt="img"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>java内部类</title>
      <link href="/2020/01/30/java%E5%86%85%E9%83%A8%E7%B1%BB/"/>
      <url>/2020/01/30/java%E5%86%85%E9%83%A8%E7%B1%BB/</url>
      
        <content type="html"><![CDATA[<h2 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h2><p>成员内部类 （~成员变量）</p><p>静态成员内部类（~静态成员变量）</p><p>局部内部类（~局部变量）</p><p>匿名内部类</p><h2 id="成员内部类"><a href="#成员内部类" class="headerlink" title="成员内部类"></a>成员内部类</h2><p>成员内部类，就像是类的成员一样</p><h3 id="1-成员内部类定义的位置"><a href="#1-成员内部类定义的位置" class="headerlink" title="(1) 成员内部类定义的位置"></a>(1) 成员内部类定义的位置</h3><blockquote><p>与成员变量和成员方法<strong>同级</strong></p></blockquote><h3 id="2-成员内部类访问外部类"><a href="#2-成员内部类访问外部类" class="headerlink" title="(2) 成员内部类访问外部类"></a>(2) 成员内部类访问外部类</h3><p>(2-1) 成员内部类可以无条件访问外部类的所有属性和方法（包括私有属性和私有方法）</p><blockquote><p>为什么？</p><p>因为成员内部类和成员方法同级。</p><p>成员方法 可以访问 本类中的私有属性和私有方法</p><p>成员内部类 也可以访问 外部类中的私有属性和私有方法</p></blockquote><p>(2-2) 成员内部类访问外部类的同名属性和同名方法：</p><ul><li>外部类.this.同名属性</li><li>外部类.this.同名方法</li></ul><pre><code>public class Outer {    // 成员变量    private int num = 99;    private int num2 = 55;    // 成员内部类    class Inner {        private int num2 = 66;        public void innerMethod(){            // 内部类访问外部类的私有属性（不同名）            System.out.println(num);    //99            // 内部类访问外部类的私有属性（同名）            System.out.println(num2);   //66            System.out.println(Outer.this.num2);    //55        }    }}</code></pre><h3 id="3-外部类访问成员内部类"><a href="#3-外部类访问成员内部类" class="headerlink" title="(3) 外部类访问成员内部类"></a>(3) 外部类访问成员内部类</h3><ul><li>创建内部类对象 (2种方式)：<code>外部类.内部类 inner = new 外部类().new 内部类();</code></li><li>访问内部类的成员：<code>inner.内部类属性;</code> —- <code>inner.内部类方法()</code></li></ul><pre><code>public class Test {    public static void main(String[] args)  {        // 第一种方式：创建内部类对象        Outer.Inner inner = new Outer().new Inner();  //必须通过Outter对象来创建        // 调用内部类对象的方法        inner.innerMethod();        // 第二种方式：创建内部类对象        Outer.Inner inner1 = outer.getInnerInstance();    }}class Outer {    // 成员变量    private int num = 99;    private int num2 = 55;    // 成员内部类    class Inner {        private int num2 = 66;        public void innerMethod(){            // 内部类访问外部类的私有属性（不同名）            System.out.println(num);    //99            // 内部类访问外部类的私有属性（同名）            System.out.println(num2);   //66            System.out.println(Outer.this.num2);    //55        }    }}</code></pre><h3 id="4-成员内部类的权限问题"><a href="#4-成员内部类的权限问题" class="headerlink" title="(4) 成员内部类的权限问题"></a>(4) 成员内部类的权限问题</h3><p>内部类可以拥有private访问权限、protected访问权限、public访问权限及包访问权限。</p><p>和外部类有一点不一样，外部类只能被public和包访问两种权限修饰。</p><p>由于成员内部类看起来像是外部类的一个成员，所以可以像类的成员一样拥有多种权限修饰。</p><p>如果成员内部类Inner用private修饰，则只能在外部类的内部访问，如果用public修饰，则任何地方都能访问；如果用protected修饰，则只能在同一个包下或者继承外部类的情况下访问；如果是默认访问权限，则只能在同一个包下访问。</p><h2 id="局部内部类"><a href="#局部内部类" class="headerlink" title="局部内部类"></a>局部内部类</h2>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
